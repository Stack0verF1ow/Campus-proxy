!function(e){"use strict";var t=SFCommon,a=SFConfig,r=SFLOG,d="jssdk:dto";e.getInitConfigDTO=function(e){return delete e.ErrorCode,e.startAuth=parseInt(e.StartAuth,10),delete e.StartAuth,e.twfID=e.TwfID,delete e.TwfID,e.csrfRandCode=e.CSRF_RAND_CODE,delete e.CSRF_RAND_CODE,e.rndImg=parseInt(e.RndImg,10),delete e.RndImg,e.anonymous=parseInt(e.Anonymous,10),delete e.Anonymous,e.denyNormalUser=parseInt(e.Deny_normal_user,10),delete e.denyNormal_user,e.autoInstall=parseInt(e.Autoinstall,10),delete e.Autoinstall,e.softKey=parseInt(e.Softkey,10),delete e.Softkey,e.enableSavePwd=parseInt(e.enablesavepwd,10),delete e.enablesavepwd,e.enableAutoLogin=parseInt(e.enableautologin,10),delete e.enableautologin,e.enableAutoRelogin=parseInt(e.enableautoRelogin,10),delete e.enableautoRelogin,e.enableThirdPartyCert=parseInt(e.enablethirdpartycert,10),delete e.enablethirdpartycert,e.enableWechatQrcode=parseInt(e.enablewechatqrcode,10),delete e.enablewechatqrcode,e.certCodeType=parseInt(e.certcodetype,10),delete e.certcodetype,e.isEnableMultClient=parseInt(e.Is_enable_mult_client,10),delete e.Is_enable_mult_client,e.multClientguid=parseInt(e.Mult_client_guid,10),delete e.Mult_client_guid,e.isMultclientVersion=parseInt(e.Is_multclient_version,10),delete e.Is_multclient_version,e.unforceInstallClient=parseInt(e.IS_UNFORCE_INSTALLECAGENT,10),delete e.IS_UNFORCE_INSTALLECAGENT,e.multiLine=parseInt(e.Multiline,10),delete e.Multiline,e.domainSSOEnable=parseInt(e.DomainSSOEnable,10),delete e.DomainSSOEnable,e.domainSSOUrl=e.DomainSSOUrl,delete e.DomainSSOUrl,e.denyAccessWithoutCom=parseInt(e.DenyAccessWithoutCom,10),delete e.DenyAccessWithoutCom,e.deviceType=parseInt(e.DeviceType,10),delete e.DeviceType,e.sslCipherSuite=parseInt(e.SSLCipherSuite,10),delete e.SSLCipherSuite,e.rsaEncrtptKey=e.RSA_ENCRYPT_KEY,delete e.RSA_ENCRYPT_KEY,e.rsaEncryptExp=parseInt(e.RSA_ENCRYPT_EXP,10),delete e.RSA_ENCRYPT_EXP,e.resetPassWord=parseInt(e.RESET_PASSWORD,10),delete e.RESET_PASSWORD,e.usbKeyDll=parseInt(e.USB_KEY_DLL,10),delete e.USB_KEY_DLL,e.allowBindSms=parseInt(e.AllowBindSms,10),delete e.AllowBindSms,e.gmVersion=parseInt(e.GMVERSION,10),delete e.GMVERSION,e.vpnVersion=parseInt(e.VPNVERSION,10),delete e.VPNVERSION,e.sslAlgor=parseInt(e.SSLALGOR,10),delete e.SSLALGOR,e.eFlag=parseInt(e.EFlag,10),delete e.EFlag,e.extra=e.Extra,delete e.Extra,e.enableMidAtkCheck=parseInt(e.MID_ATK_CHECK,10),delete e.MID_ATK_CHECK,e.clientRunMode=parseInt(e.clientRunMode||0,0),e.securityCheck=null,t.checkObjAttrExits(e,"SecurityCheck.strategies.strategy")&&(e.securityCheck=t.clone(e.SecurityCheck),e.enableSecurityCheck=!0,is.array(e.SecurityCheck.strategies.strategy)?e.securityCheck.list=e.SecurityCheck.strategies.strategy:(e.securityCheck.list=[],e.securityCheck.list.push(e.SecurityCheck.strategies.strategy))),e},e.getSettingConfigDTO=function(e){return delete e.ErrorCode,e.htpEnable=e.HTP_ENABLE,delete e.HTP_ENABLE,e.htpAuto=e.HTP_AUTO,delete e.HTP_AUTO,e.htpParam=e.HTP_PARAM,delete e.HTP_PARAM,e.htpPort=e.HTP_PORT,delete e.HTP_PORT,e.htpMTU=e.HTP_MTU,delete e.HTP_MTU,e.general=e.V_ISHIDUSR,delete e.V_ISHIDUSR,e.perInfo=e.V_ISPUBUSR,delete e.V_ISPUBUSR,e.username=e.USER_NAME,delete e.USER_NAME,e.perSSOInfo=e.ENABLESSO,delete e.ENABLESSO,e.adminEnableSCache=e.ADMINENABLESCACHE,delete e.ADMINENABLESCACHE,e.enableAutoRelogin=e.EnableAutoRelogin,delete e.EnableAutoRelogin,e.enableAutologin=e.EnableAutologin,delete e.EnableAutologin,e.unforceInstallClient=e.IS_UNFORCE_INSTALLECAGENT,delete e.IS_UNFORCE_INSTALLECAGENT,e.rmtApp=e.T_REMOTEAPP_ENABLE,delete e.T_REMOTEAPP_ENABLE,e.woptEnable=e.T_WOPT_ENABLE,delete e.T_WOPT_ENABLE,e.woptDevice=e.T_WOPT_DEVICE,delete e.T_WOPT_DEVICE,e},e.getAccountDataDTO=function(e){return delete e.ErrorCode,e.pwdPolicyMsg=e.PWD_MSG,delete e.PWD_MSG,e.isallowChgPsw=e.FLAG_CHG_PSW,delete e.FLAG_CHG_PSW,e.isallowChgPhone=e.FLAG_CHG_PHONE,delete e.FLAG_CHG_PHONE,e.isallowChgNote=e.FLAG_CHG_NOTE,delete e.FLAG_CHG_NOTE,e.isBindUSBKey=e.IsOfflineBind,delete e.IsOfflineBind,e.enBindUSBKey=e.EnableOfflineBind,delete e.EnableOfflineBind,e.isLocalPswUser=e.FLAG_ISLOCALPSWUSER,delete e.FLAG_ISLOCALPSWUSER,e.isPrivate=e.FLAG_USERMODE,delete e.FLAG_USERMODE,e.useSmsLogin=e.FLAG_USESMSLOGIN,delete e.FLAG_USESMSLOGIN,e.isLocalUser=e.FLAG_ISLOCALUSER,delete e.FLAG_ISLOCALUSER,e.hids=e.HID_LIST,delete e.HID_LIST,e.useHid=e.FLAG_USEHID,delete e.FLAG_USEHID,e.useDKey=e.FLAG_USEDKEY,delete e.FLAG_USEDKEY,e.userName=e.USER_NAME,delete e.USER_NAME,e.userNote=e.USER_NOTE,delete e.USER_NOTE,e.userMobilePhone=e.USER_MOBILEPHONE,delete e.USER_MOBILEPHONE,e.allEnablePWP=e.ALL_ENABLE_PWP,delete e.ALL_ENABLE_PWP,e.minLen=e.MINLEN,delete e.MINLEN,e.csrfRandCode=e.CSRF_RAND_CODE,delete e.CSRF_RAND_CODE,e},e.getSSODataDTO=function(e){return delete e.ErrorCode,e.flagIsLocalUserSSO=e.FLAG_ISLOCALUSER_SSO,delete e.FLAG_ISLOCALUSER_SSO,e.userID=e.SSOINFO_USERID,delete e.SSOINFO_USERID,e.ssoRcCount=e.SSOINFO_RCCOUNT,delete e.SSOINFO_RCCOUNT,e.ssoStore="undefined"!=typeof e.ssoStore?JSON.parse(e.ssoStore):[],e.userName=e.SSOINFO_USERNAME,delete e.SSOINFO_USERNAME,e},e.getListDataDTO=function(e){var t,n,l,S=e.HID_LIST,E=[];if(!S.length)return E;for(t=S.split(","),n=0;n<t.length;n++)t[n]&&(l=t[n].split("|"),E.push({hid:l[0].substr(1),macAddress:l[1],hostName:l[2].substr(0,l[2].length-1)}));return E},e.getScacheConfigDTO=function(e){return delete e.ErrorCode,e.wcEnable=e.WC_ENABLE,delete e.WC_ENABLE,e.wcMode=e.WC_MODE,delete e.WC_MODE,e.wcCount=e.WC_COUNT,delete e.WC_COUNT,e.wcURL=e.WC_URL,delete e.WC_URL,e.htpEnable=e.HTP_ENABLE,delete e.HTP_ENABLE,e.htpAuto=e.HTP_AUTO,delete e.HTP_AUTO,e.htpParam=e.HTP_PARAM,delete e.HTP_PARAM,e.htpPort=e.HTP_PORT,delete e.HTP_PORT,e.htpMTU=e.HTP_MTU,delete e.HTP_MTU,e.adminEnableSCache=e.AdminEnableSCache,delete e.AdminEnableSCache,e.gatewayID=e.GwID,delete e.GwID,e.svpnID=e.SvpnID,delete e.SvpnID,e.woptEnable=e.T_WOPT_ENABLE,delete e.T_WOPT_ENABLE,e.woptSupportDevice=e.T_WOPT_DEVICE,delete e.T_WOPT_DEVICE,e.wopt=e.T_WOPT,delete e.T_WOPT,e.autoStartCS=e.AUTOSTARTCS,delete e.AUTOSTARTCS,e},e.getHidConfigDTO=function(e){return delete e.ErrorCode,e.type=e.Result,delete e.Result,e.isAutoSetup=e.JS_AUTOSETUP,delete e.JS_AUTOSETUP,e.isCanIgnHid=e.JS_IGNHID,delete e.JS_IGNHID,e.isLBEnabled=e.ISLBENABLED,delete e.ISLBENABLED,e.isBeforeLogin=e.ISBEFORELOGIN,delete e.ISBEFORELOGIN,e.title=e.T_TITLE,delete e.T_TITLE,e.adminHint=SFCommon.handleEmptyObj(e.ADMIN_HINT,""),delete e.ADMIN_HINT,e.hidInfoMsg=SFCommon.handleEmptyObj(e.hidInfoMsg,""),e.enableSMSHid=e.ENABLE_SMS_HID,delete e.ENABLE_SMS_HID,e},e.authData=function(e){var t,n,l,S,E={code:ERROR_SERVER_DATA_FORMAT_INVALID,data:""};return e&&null!==e&&(l=e.Auth||{},(S=function checkSuccessCode(e){return 0<=[a.SUCCESS_CODE,ERRCODE_EAUTH_RELOGIN].indexOf(e)}(S=parseInt(l.ErrorCode,0)||0)?a.SUCCESS_CODE:S)===ERRCODE_EAUTH_HID_ERR&&(S=0),E.code=S,r.info(d,"this auth nextService"+SFCommon.handleEmptyObj(l.NextService)),1===E.code&&SFCommon.handleEmptyObj(l.NextService)&&(E.code=2),(n={}).NextServiceData=t=l,n.enableMAM=parseInt(t.EnableMAM,0),n.suportMDM=parseInt(t.SuportMDM,0),n.curAuth=parseInt(t.CurAuth,0),n.nextService=SFCommon.handleEmptyObj(t.NextService),n.authInfo=SFCommon.handleEmptyObj(t.AuthInfo),n.note=SFCommon.handleEmptyObj(t.Note),n.challengeMsg=SFCommon.handleEmptyObj(t.ChallengeMsg),n.smsIsStillValid=parseInt(t.SmsIsStillValid,0),n.disableTime=parseInt(t.SmsSendInterval,0),n.phone=SFCommon.handleEmptyObj(t.Phone),n.curPhone=SFCommon.handleEmptyObj(t.CurPhone),n.smsSendType=SFCommon.handleEmptyObj(t.SmsSendType),n.mdmEnable=parseInt(t.mdmEnable,0),n.mdmUqid=SFCommon.handleEmptyObj(t.mdmUqid),n.mdmUrl=SFCommon.handleEmptyObj(t.MdmUrl),n.rootRule=SFCommon.handleEmptyObj(t.RootRule),n.pwpErrorCode=parseInt(t.pwpErrorCode,0),n.pwdRemaintm=t.pwdRemaintm||"",n.csrfRandCode=t.CSRF_RAND_CODE||"",n.twfID=t.TwfID||"",n.certUserName=SFCommon.handleEmptyObj(t.CERT_USERNAME),n.isFirstAuth=parseInt(t.IsFirstAuth,0),n.wechatBindStatus=parseInt(SFCommon.handleEmptyObj(t.WechatBindStatus,0),10),n.twfID?(r.info(d,"set new twfid from auth data"),SF.session.createInstance().setTWFID(n.twfID)):r.info(d,"no new twfid from auth data"),n.pwdRemaintm=SFCommon.handleEmptyObj(t.pwdRemaintm),E.data=n),E},e.authOtherData=function(e,t){var n,l,S,E,a={code:"",data:""};function number(e){return parseInt(e||0,0)}return e&&(E=(S=e.Auth||{}).ErrorCode||0,a.code=number(E),(l={}).NextServiceData=n=S,"getPswConfig"===t?(l.encryptExp=number(n.RSA_ENCRYPT_EXP),l.enableResetPsw=number(n.RESET_PASSWORD),l.enableKeypad=number(n.USE_SOFT_KB),l.showSetup=number(n.COMP_LINK_INFO),l.showHelpCenter=number(n.SHOW_HELP_LINK),l.enableDKeyVer=number(n.DKEY_VER_ENABLE),l.enableRandCode=number(n.USE_RAND_CODE),l.enableAnonymous=number(n.ALLOW_ANONYMOUS_ACCESS),l.denyNormalAccess=number(n.DENY_NORMAL_ACCESS),l.enableMidAtkCheck=number(n.MID_ATK_CHECK),l.encryptKey=SFCommon.handleEmptyObj(n.RSA_ENCRYPT_KEY),l.enableMultClient=number(n.IS_ENABLE_MULT_CLIENT),l.multClientGuid=SFCommon.handleEmptyObj(n.MULT_CLIENT_GUID),l.isMultclientVersion=number(n.IS_MULITCLIENT_VERSION),l.unforceInstallClient=number(n.IS_UNFORCE_INSTALLECAGENT),l.randCodeURL=SFCommon.handleEmptyObj(n.RAND_CODE_URL),l.showSvpnTool=number(n.SHOW_TOOL_LINK),l.csrfRandCode=SFCommon.handleEmptyObj(n.CSRF_RAND_CODE)):"getSmsConfig"===t?(l.disableTime=number(n.SmsSendInterval),l.phone=SFCommon.handleEmptyObj(n.USER_PHONE),l.smsApps=SFCommon.handleEmptyObj(n.SMS_SENDTYPE),l.isValid=number(n.IS_IN_PERIOD),l.smsInfo=SFCommon.handleEmptyObj(n.T_SMSINFOR),l.currentPhone=number(n.CURRENT_PHONE)):"getSmsCode"===t&&(l.disableTime=number(n.disableTime)),a.data=l),a}}(SFDTO);