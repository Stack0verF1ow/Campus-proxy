/**
 * 登录信息和vpn同步信息保存
 */
!function(g){function l(){var c,e,b,g=SFLOG;b=this;b.getLoginInfo=function(){if(SFCommon.isWeb())return{};c=SF.setting.getVPN(KEY_VPN_LOGIN_INFO,{});return SFCommon.clone(c)};b.setLoginInfo=function(a){if(SFCommon.isWeb())return{};a=a||{};c=SFCommon.extend(c,a)};b.syncLoginInfo=function(){var a,f;k.getResult(1);SF.setting.setGlobal({key:KEY_GLOBAL_LOGIN_CLIENT_TYPE,value:SFConfig.container},!1);if(SFCommon.isWeb())return{};g.debug("module:vpnInfo","sync login info");f=b.getLoginInfo();a=b.getTempLoginInfo();f.userName&&f.userName===a.userName?(g.debug("module:vpnInfo","username of history is diff with current temp username, should be instead."),a=k.extend(f,a)):f.hasOwnProperty("showRc")&&!a.hasOwnProperty("showRc")&&(a.showRc=f.showRc);SF.setting.setVPN({key:KEY_VPN_FIRST_AUTH,value:b.getTempFirstAuth()},!0);b.saveLoginInfo(a);b.clearTempInfo()};b.getFirstAuth=function(){return SF.setting.getVPN(KEY_VPN_FIRST_AUTH,"")};b.setTempFirstAuth=function(a){SF.setting.setVPN({key:KEY_VPN_TEMP_FIRST_AUTH,value:a},!1)};b.getTempFirstAuth=function(){return SF.setting.getVPN(KEY_VPN_TEMP_FIRST_AUTH,"")};b.saveLoginInfo=function(a){if(SFCommon.isWeb())return{};c=a||{};c.password&&!c.savePwd&&(c.password="");SF.setting.setVPN({key:KEY_VPN_LOGIN_INFO,value:c},!0)};b.getTempLoginInfo=function(){e=SF.setting.getVPN(KEY_VPN_TEMP_LOGIN_INFO,{});return SFCommon.clone(e)};b.saveTempLoginInfo=function(a){a=a||{};a.userName&&a.userName!==e.userName&&(e={});e=SFCommon.extend(e,a);SF.setting.setVPN({key:KEY_VPN_TEMP_LOGIN_INFO,value:e},!1)};b.clearTempInfo=function(){e={};SF.setting.setVPN({key:KEY_VPN_TEMP_LOGIN_INFO,value:{}},!1);SF.setting.setVPN({key:KEY_VPN_TEMP_FIRST_AUTH,value:""},!1)};b.getVPNURLList=function(){return SF.setting.getGlobal(KEY_GLOBAL_VPN_URL_LIST,[])};b.setLastVPNURL=function(a){var f=b.getVPNURLList(),d=[],c;a&&(c=SFCommon.parseURL(a),d.push(a),f.forEach(function(a){SFCommon.parseURL(a)!==c&&d.push(a)}),10<d.length&&(d=d.slice(0,10)),SF.setting.setGlobal({key:KEY_GLOBAL_LAST_VPN_URL,value:a},!0),SF.setting.setGlobal({key:KEY_GLOBAL_VPN_URL_LIST,value:d},!0),(SFCommon.isMacClient()||SFCommon.isLinuxClient())&&SF.ecConfig.write({key:SF.ecConfig.key.LAST_VPN_URL,value:a}))};b.deleteVPNURL=function(a){var c=b.getVPNURLList(),d=[];a&&(c.forEach(function(b){a!==b&&d.push(b)}),SF.setting.setGlobal({key:KEY_GLOBAL_LAST_VPN_URL,value:d[0]?d[0]:""},!0),SF.setting.setGlobal({key:KEY_GLOBAL_VPN_URL_LIST,value:d},!0),c=SF.setting.getGlobal(KEY_GLOBAL_FROM_URL,""),SF.setting.setGlobal({key:KEY_GLOBAL_FROM_URL,value:a},!1),b.saveLoginInfo({}),SF.setting.setGlobal({key:KEY_GLOBAL_FROM_URL,value:c},!1))};b.getLastVPNURL=function(){return SF.setting.getGlobal(KEY_GLOBAL_LAST_VPN_URL,"")}}var h,k=SFCommon;g.vpnInfo=g.vpnInfo||{};g.vpnInfo.createInstance=function(){is.empty(h)&&(h=new l);return h}}(SF);